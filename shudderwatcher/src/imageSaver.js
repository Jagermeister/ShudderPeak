const fs = require('fs');
const request = require('request');
const config = require('./config.json');


const imageKeys = ["425618","553734","1","55338","580116","1615837","354","491570","1640626","1350712","453828","143778","761925","357","87","616396","64138","1629545","3792","402861","1522836","1093948","488822","963599","9","88","519985","984722","790940","790975","157543","25","738001","1517411","788264","984710","973","84608","1560128","1199606","822104","191762","191763","191764","191767","461298","1003187","1003189","58754","402543","120098","115847","11","4339","2","1609931","62833","439","1254672","58765","1009573","1175824","614315","1409309","145315","1221184","1523510","114836","62834","41","939499","33","160400","34700","1615795","28087","1544688","81248","1012394","1405594","904865","1449979","160401","156921","839340","1265577","1474312","1130539","984781","90076","877388","120079","1305262","100590","876390","1555981","1287994","1902","1556042","22639","17662","188854","445","8","1581225","984740","1601651","1120428","1555988","194823","194824","194825","805992","135916","133468","1010322","1396977","1523842","963234","650731","626795","426163","184115","360","153556","1519432","772278","1644025","120688","86","1190286","38436","497760","1623291","1138925","58741","761930","1429210","1555970","57993","611786","980171","1340316","1613710","984720","612979","1406119","775192","1404891","1555993","967449","62152","743904","746473","746478","1313136","1555961","608278","106169","1904","1265923","743875","1582115","3","116625","1158169","1158171","1158172","1613113","1581192","1581194","1582804","1582807","858728","1629531","138344","1178887","1233524","1207531","1644388","1595780","439806","245","697696","1140023","778454","1629525","1547903","10","1581185","1581191","68856","160395","1030811","12","520011","933121","933135","963686","1176025","1640230","120064","120066","120067","120068","70732","1565289","784102","115845","480045","194595","599547","1321025","119331","819891","319636","1530208","433","113514","975039","117640","18","746451","52","1557244","988596","166266","1441276","106294","1603409","1212747","1045255","34","1090060","1178891","1595357","46440","1529742","1441271","17","106293","832962","1626729","1057656","1384116","1384126","311534","425671","425688","1204050","1015280","1207074","141798","115846","944962","738018","107030","1290325","489","817299","4","1566950","1012403","190976","1338257","4057","992519","212205","212206","1288770","762002","405904","440","521050","155877","1629553","1019048","116051","134253","28","1063575","960003","785177","743892","743899","743922","878700","895066","1035672","36","120711","74510","70433","81997","115848","106233","780100","872239","966819","112291","121815","106205","107731","1426775","168930","106204","106175","244","112379","880743","880744","69","1063566","108650","143635","143636","30259","743849","6937","509598","738188","120232","987151","160404","24631","81274","44067","793922","108917","79935","1178843","822126","191447","110301","5","30","1049447","1629560","1404069","36535","112292","1406154","97724","58127","81103","1389118","4337","1000361","1287627","800332","1629561","705194","22998","146960","103048","785195","69042","6","194622","194623","1470037","1429207","1601644","1445967","1467415","1445964","118783","854657","1226804","1629546","363438","1445974","1319449","1176012","184815","1533564","1539743","650732","127055","1405533","763387","1252448","449880","185545","966822","1643617","904877","1556022","1630115","642206","14856","1554088","738126","1232583","1607019","17068","1190282","1546479","294317","958135","997588","1130807","205344","146060","1405911","76383","1629557","166174","108871","1431286","1484303","126479","102242","1387456","82820","776615","737657","1629536","78083","191313","100249","1394678","1397652","1187479","1287537","1289964","1564353","478057","1629543","1629520","1629541","1629548","409139","1639122","179995","1597801","1629522","1557252","1441289","126817","133509","128660","420049","420051","813617","1629533","1317272","1629535","1335413","81249","102130","1611444","1629528","1639124","1116700","826562","1637682","1150492","1574694","1011839","1566951","205342","1178840","1557386","1637613","106170","1558206","1558207","1028959","939496","966714","115844","121817","1578496","1176035","813614","1645874","1407495","1066466","1646903","136505","1243364","535268","535269","535272","535274","746637","746638","746641","746642","757045","757047","757049","757051","703458","7","1563063","1178884","147833","81462","996454","186146","1381860","118250","8292","69729","1612544","160402","4040","47","1462622","98562","581053","1557381","402551","1364487","1141818","426175","1612580","1572430","634990","1557250","496","1541870","446979","160403","1593730","1265775","32438","1438508","76318","108918","858224","92934","1366306","1629556","483","196892","62835","143490","137838","148782","878716","876449","1230711","1564358","1441281","136902","1523327","143156","766448","1064987","1064988","1064995","1064991","1130348","1130349","1297279","1297281","1606713","184818","118456","1048016","40619","902807","472328","903777","49106","1207397","164989","1557245","333074","1593169","834207","963604","1449814","114870","859067","117650","811310","12576","116948","1088278","1406118","1454687"];

const imageMaxCount = imageKeys.length;
let currentImageIndex = 0;

function saveCurrentImage() {
    const key = imageKeys[currentImageIndex];
    console.log(currentImageIndex, key);
    request
        .get(config.imageEndpoint.replace('{id}', key))
        .pipe(fs.createWriteStream(`../images/${key}.png`));
    currentImageIndex++;
    if (currentImageIndex < imageMaxCount) {
        setTimeout(saveCurrentImage, 1000);
    }
}

saveCurrentImage();
